###
### {{ ansible_managed }}
###
{% set count = namespace(value=0) %}

#### Manually provided user list from ul_podman_users

{% for user in ul_podman_mappings_users %}
{% set count.value = count.value + 1 %}
{{ user }}:{{ ul_podman_mappings_base_id + ((count.value - 1) * ul_podman_mappings_range) }}:{{ ul_podman_mappings_range }}
{% endfor %}

#### Automatically generated user list from getent passwd

{% if ul_podman_mappings_automatic %}
{% for user in getent_passwd %}
{% if getent_passwd[user][1] | int >= 1000 and user != 'nfsnobody' and user not in ul_podman_mappings_users %}
{% set count.value = count.value + 1 %}
{{ user }}:{{ ul_podman_mappings_base_id + ((count.value - 1) * ul_podman_mappings_range) }}:{{ ul_podman_mappings_range }}
{% endif %}
{% endfor %}
{% endif %}
