---
#
# How to invoke on localhost:
#
#   env-ansible
#   ansible-playbook --inventory hosts.localhost playbooks/localhost.yml
#
- name: Deploy the current box based on local facts (coda19.host.role)
  hosts: localhost
  connection: local
  vars_files:
    - "{{ playbook_dir }}/../group_vars/s{{ ansible_local.coda19.site.id }}"
    - "{{ playbook_dir }}/../vaults/vault.{{ ansible_local.coda19.site.id }}"

  tasks:

    - name: INCLUDE_ROLE | _ORANGE
      include_role:
        name: _orange
      when: "ansible_local.coda19.host.role|lower == 'orange'"
      tags:
        - always

    - name: INCLUDE_ROLE | _GREEN
      include_role:
        name: _green
      when: "ansible_local.coda19.host.role|lower == 'green'"
      tags:
        - always

    - name: INCLUDE_ROLE | _PURPLE
      include_role:
        name: _purple
      when: "ansible_local.coda19.host.role|lower == 'purple'"
      tags:
        - always
